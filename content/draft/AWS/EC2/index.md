---
title: "#2 AWS SAAメモ インフラ・VPC"
postdate: "2021-10-08"
update: "2021-10-08"
seriesName: "AWS SAA勉強メモ"
seriesSlug: "AWS"
description: ""
tags: ["AWS", "AWS SAA", "VPC"]
draft: true
---

# EC2

|a|a|
|---|---|
|オンデマンドインスタンス|秒単位で料金発生|
|リザーブドインスタンス|1年か3年を指定して予約|
|スケジュールドリザーブドインスタンス|1年間、指定した期間だけ繰り返しキャパシティー予約|
|スポットインスタンス|未使用のインスタンスを利用できる|

## インスタンスタイプ

|ファミリー|説明|
|---|---|
|t|汎用|
|A|〃|
|M|〃|
|C|コンピューティング(機械学習など)|
|X、R|メモリー最適化|
|H、D、I|ストレージ最適化|

## ユーザーデータ

スクリプトを実行してLinuxの初期設定を自動化できる。ホスト名の変更、ロケール設定、yumアップデートなど。

![](./images/userdata.png)

## 起動テンプレート

EC2起動のテンプレート化。

AMI、インスタンスタイプ、キーペア、SG、ストレージ、タグ、ユーザーデータなどをテンプレートとして保存。

## スポットリクエスト

### スポットフリート

複数のスポットインスタンスをグループ化して一括管理。EC2フリートというのもある。

## リザーブド

AZ、インスタンスサイズ、ネットワークタイプの変更が可能。

### スタンダード

インスタンスファミリー、OS、テナンシー、支払いオプションんの途中変更が不可。その代わり安い。

1年 - 40%、3年だと60%割引。

### コンパーティブル

途中変更が可能。

1年だと31%、3年だと54%。

## リザーブドインスタンス

OSとインスタンスタイプの組み合わせごとに購入が可能。対象インスタンスを選択できない。

### Standard RI

途中のインスタンスタイプの変更が出来ない代わりに割引率は大きいです。

### Convertible RI

途中のインスタンスタイプの変更が出来る代わりに割引率は小さいです。

## Saving Plans

時間単位の利用料先払い。柔軟性が高い。

## 専用ホスト

**物理サーバーを占有**する。

## キャパシティの予約

**オンデマンドインスタンス**のキャパシティを予約できる。多くのインスタンスを起動しようとしたときに失敗することがあるが、それを防げる。ただし割引はない。

## ハイバネーション(インスタンスの休止)

停止と休止の違いは、休止の方が再開までの時間が短くなる。メモリにデータが保管さるので復旧が早い。ハイバネーションを使用するには、対象となるインスタンスであること、さらに設定が必要である。インスタンスストアのデータは失われる。

### Compute Savings Plans

EC2、EMR、ECS、EKSクラスターの一部、Fargate、Lambda。最大66%の割引が可能。

### EC2 Instance Savings Plans

EC2インスタンスのみに割引が適用、最大72%の割引。

https://dev.classmethod.jp/articles/ec2-reserved-instances-savings-plans-comparison/

https://blog.serverworks.co.jp/reserved-instance-savings-plan

https://dev.classmethod.jp/articles/ec2-reserved-instances-savings-plans-comparison/

## AMI

AMIはリージョンにおいて一意。他のリージョンで使いたいときはコピーする。

他のアカウントとも共有可能。

## EC2 Image Builder

AMIを作った後のバージョン更新にも対応してくれる。




## ストレージ

### インスタンスストア

サーバーにアタッチされているストレージ。EC2の一時的なデータが保存。EC2起動終了と同時に削除される。

直接アタッチされているのでIOは早い。

### EBS

ネットワーク接続されたブロックレベルストレージ。

設定すれば、EC2を終了してもデータの保存が可能。また、スナップショットをS3に保存可能。

EBS料金が発生。

## EBS

他のインスタンスに付け替えることができる。ただしAZをまたぐことはできない。

基本的に複数のインスタンスを接続させることはできない。プロビジョンドIOPSのみできる。

スナップショットをとり、S3に保存することでバックアップを行う。2回目以降は増分バックアップ。S3に保存するので、リージョンをまたいで共有可能。

権限委譲で別アカウントにも共有可能。

AWS KMSで暗号化を行う。

## ボリュームタイプ

