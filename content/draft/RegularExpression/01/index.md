---
title: "#1 苦しんで覚える正規表現"
postdate: "2022-06-16"
update: "2022-06-16"
seriesName: "苦しんで覚える正規表現"
seriesSlug: "RegularExpression"
description: "正規表現を学習します。"
tags: ["正規表現"]
keywords: ["正規表現", "Regular Expression"]
---

# 正規表現を覚えよう

## 正規表現に便利なWebサイト

JavaScriptのコードを書いて正規表現を勉強するのもいいですが、Webサイトを利用すればより視覚的に分かりやすく正規表現を学ぶことができます。

画面、機能ともにシンプルという理由で、このシリーズでは以下のサイトを利用します。

https://scriptular.com/

例題として、IP v4アドレスを取り上げます。

```
10.0.0.1
172.24.50.11
192.168.50.111
10.1.50.1111
192 168 50 111
```

上記のように、5つのIPアドレスっぽい文字列を用意します。しかしよく見ると、IPアドレスではないものが混じっています。上から4つ目は第4オクテットが`1111`と4桁になっています。また、上から5つ目は`.`ではなく半角スペースが使用されています。

このような文字列が数百、数千と並んでいる状況を想像してみましょう。IPアドレスとして正しいかを目視で判定していくのは無理がありますね。こんな時は正規表現を使用すれば一発です。

まずは「Test Strings:」の欄に上記の文字列を入力します。

![](./images/image01.png)

次に「Regular Expression:」欄に以下の正規表現を入力します。

```js
^(\d{1,3}\.){3}\d{1,3}$
```

![](images/image02.png)

すると、「Match Results:」の欄に入力した正規表現にマッチした行だけが表示されるようになります。

![](./images/image03.png)

<adide>

上記の正規表現は正確にIPアドレスを判定するものではありません。例えば`999.999.999.999`という文字列もマッチすると判定してしまいます。

上記の正規表現は「3桁の数字の後に`.`が続くのが3つ、その後に3桁の数字が続くものにマッチする」という内容です。例題として参考程度でお願いします。

</aside>

JavaScriptであれば以下のようなサイトが利用できます。

### regex101: build, test, and debug regex

https://regex101.com/

私はいつもこのサイトを利用しています。JavaScriptの他にも、PHP、Python、Golang、Java、.NET C#にも対応しています。

## `\d`で数値を表す

`\d`は**1個の半角数値**を表します。

「TEST STRING」に`172.168.24.111`と入力し、「REGULAR EXPRESSION」には`\d`と入力します。

すると正規表現にマッチした部分（つまり、1個の半角数字）が全て青くマークされます。

1個の半角数値ですので、`0`から`9`までの数値が全て対象になります。例えば`999.357.964.800`といった、IP v4ではない文字列でもヒットします。あくまで「`数値3個`、`.`、`数値3個`、`.`、`数値3個`、 `.`、`数値3個`」の並びにヒットする正規表現です。

## 量指定子

## 文字クラス

[Aa]なら、`A`もしくは`a`がマッチします。例えば`[Cc]lass`とすれば、`Class`と`class`のどちらにもマッチします。

## 文字クラスの除外

`^`（キャレット）を使用することで、その文字がマッチから除外されます。`/sample[A]/`なら`sampleA`はマッチしません。`A`以外の文字であればマッチします。

また、`[^AaBb]`という風に指定した場合には、これら4つの文字全てがマッチから除外されます。

## 文字の範囲

例えば`A`から`Z`までの文字、いずれかにマッチする条件を指定したいとき、`-`（ハイフン）を使用して範囲を指定できます。

`/sample[A-Z]/`とすると、`sample`という文字列の後に`A`から`Z`が続くパターンがマッチします。`samplea`や`sample1`などはマッチしません。

そして複数の範囲を指定することもできます。`[0-9a-zA-z]`なら、`0`から`9`、`a`から`z`、`A-Z`のいずれか一文字とマッチします。

## 0回以上の繰り返し

`*`（アスタリスク）を使用することで、任意の文字の`0回以上の繰り返し`とマッチさせることができます。

`sample[1]*.txt`であれば、`sample.txt`とも`sample1.txt`とも`sample1111.txt`ともマッチします。

0個以上の何かとマッチさせるのを**閉包**と言います。

## 1個以上の繰り返し

`+`を使用することで、任意の文字の**1回以上の繰り返し**とマッチさせることができます。

`/sample[1]+.txt/`であれば、`sample1.txt`とも`sample1111.txt`ともマッチします。しかし、`sample.txt`とはマッチしません。

## 0個か1個か

`?`を使用することで、任意の文字の**0回か1回**を表現することができます。

`/sample[\d]?.txt`ならば`sample.txt`（`\d`が0回）とも`sample1.txt`（`\d`が1回）ともマッチします。しかし、`sample11.txt`（`\d`が2回）とはマッチしません。


## 位置を表すメタ文字

### キャレット

キャレットは**先頭**を表すメタ文字です。

```title=sample
*** *** OK
OK *** ***
*** OK ***
```

このようなファイルがあったとして、先頭に`OK`が現れる行だけマッチさせたいとします。単純に`/OK/`とだけ入力しても、3行ともにマッチしてしまい、上手くいきません。

キャロットを使用すれば、先頭に`OK`がある行だけマッチさせることができます。

### $

`$`は行末を表すメタ文字です。



`^$`とすることで空白行とマッチさせることができます。単純に空白行を抜き出すことは少ないと思いますが、**sed**コマンドなどと組み合わせる場面なら活用できます。

