---
title: "Linux"
postdate: "2021-10-01"
update: "2021-10-01"
seriesName: "ラーニングGatsby"
seriesSlug: "LearningGatsby"
description: ""
tags: ["Gatsby", "SSG"]

---

## カーネルモジュール

`lsmod`もしくは`/proc/modules`を参照する。

## DMA

CPUを介することなくメインメモリと周辺機器の間で直接的に情報転送を行う方式。`/proc/dma`を参照。

## メモリーの使用状況

`/proc/meminfo`を参照。

## PCIデバイス

`lspci`で取得。もしくは`/proc/bus/pci/devices`。

## I/Oポートアドレス

I/Oポートアドレスとは周辺機器(デバイス)とCPUがデータをやり取りする際に使用する16ビットのアドレスのことです。

## `modprobe`

依存関係を考慮しカーネルモジュールをロードする。`/etc/modprobe.d/`の`.conf`が設定ファイル。

- options: 各カーネルモジュールのデフォルトパラメータを指定する
- alias: カーネルモジュールに別名をつける
- install: 特定のカーネルモジュールのロード時に実行されるコマンドを指定する
- remove: 特定のカーネルモジュールのアンロード時に実行されるコマンドを指定する
- blacklist: ロードしたくないカーネルモジュールを指定する

## `udev`

カーネルはデバイスを検知すると「/sys」以下（sysfsと呼ばれます）の情報を更新しますが、その更新をudevは検知し、/dev以下にデバイスファイルを動的に作成します。
デバイスファイル作成時の動作は、「/etc/udev/rules.d」ディレクトリに配置された設定ファイル（拡張子「.rules」）に記述された情報に基づいて行われます。

## cpuの情報

`/proc/cpuinfo`

## USBデバイス

`lsusb`、`/proc/bus/usb/devices`。

`/proc/interrupts`

# initプログラム

Upstart

ジョブ、イベント駆動型、並列処理が可能

## 初期RAMディスク

・ファイルシステムへアクセスするのに必要なドライバやスクリプトが含まれている
・カーネルイメージと同様に「/boot」ディレクトリに格納される
・カーネルのバージョンごとに内容が異なる

# SysVinit

`telinit q`、`init Q`で`/etc/inittab`の変更を即座に反映する。

# systemd

扱う処理をUnitという単位で管理する

サービスの並列起動によって高速なシステム起動や停止が行える

cgroupsでプロセスのリソースを管理する

## systemd-journald

各サービスのログを扱う

## cgroups

プロセスのリソース管理

## /proc/cmdline

ブートローダーからカーネルに渡されたパラメーター


# ランレベル

`systemctl rescue`でシングルユーザーモードに切り替える。`systemctl default`、`Ctrl-D`を実行するか、`systemctl reboot`で再起動すると元に戻る。


`runlevel.target`、`rescue.target`

マルチユーザー`2, 3, 5`

マルチユーザー、GUIログイン`5`


## ランレベルの変更

`init`、`telinit`

## 一つ前のランレベル

`runlevel`

## 次回起動時のランレベル

`/etc/systemd/system`のシンボリックリンク`default.target`確認する。

`shutdown -h +60`

`systemd`システムなら`systemctl get-defalut`で確認する。

`systemctl set-default graphical.target`などで次回を指定する。

# Debian

# apt系

`apt-cache`

パッケージ情報の検索・参照。

- `depends` 依存しているパッケージ一覧
- `showpkg` 依存しているパッケージの詳細情報
- `show` パッケージの情報

`apt-get`

- `update` データベースを最新版に更新
- `upgrade` インストールしているパッケージをアップグレード

`apt`

リポジトリーは`/etc/apt/sources.list`で設定する。

`dpkg`

設定ファイルは`/etc/dpkg/dpkg.cfg`。

> 「-G」オプションを併用することで、既に新しいバージョンのパッケージがインストールされている場合は、インストールを行わないようにすることができます。

> 「-E」オプションを併用することで、既に同じバージョンのパッケージがインストールされている場合は、インストールを行わないようにできます。

- `-R` ディレクトリーを再帰処理
- `-l` `--list` インストール済みパッケージの一覧
- `-L` `--listfiles` あるパッケージからインストールされたファイル一覧
- `-s` `--status` インストール済みパッケージの詳細情報
- `-r` `--remove` 設定ファイルを残してパッケージを削除
- `-P` `--purge` 設定ファイルごとパッケージを削除
- `-C` `--audit` 不完全なパッケージの表示
- `-S` `--search` 指定したファイルがどのパッケージからインストールされたか


# yum

設定ファイル`/etc/yum.conf`。

リポジトリー。`/etc/yum.repos.d/`

YUMの後継`dnf`。リポジトリーもYUMと同じ`/etc/yum.repos.d/`。

パッケージグループの表示。`grouplist`

`search`

`check-update`


# ZYPPER

openSUSEで使用されます。

`install`か`in`でパッケージインストール。

キーワードを含むパッケージ。`search`、`se`

- `repos`、`lr`
- `search`、`se`
- `remove`、`rm` パッケージのアンインストール

# rpm

## オプション

`-i`、`--install` インストール
`-e`、`--erase`でアンインストール。
`-q`、`--query` パッケージがインストールされているか
`-U`、`--upgrade` アップグレード（なければインストール）
`-F`、`--freshen` アップグレード（ある時だけ）
`-V`、`--verify`でパッケージの検査。

## 併用オプション

`-i`、`--info`で詳細情報

`-a`、`--all`で全パッケージの表示。
`-h`、`--hash`で進行状況を表示。
`-v` 詳細情報
`-R`、`--requires`で依存するファイル
`--nodeps`で依存関係を無視。
`--nomd5`で検査しない
`-f`、`--file` 指定したファイルのインストール元のパッケージを表示する
`-p`、`--package` 照会対象をパッケージファイルとする
`--test`
`-c`、`--configfiles`


`--changelog`でパッケージの変更履歴
`-l`、`--list`パッケージに含まれるファイル

rpm2cpio


https://atmarkit.itmedia.co.jp/ait/articles/1609/13/news024.html#:~:text=%E3%80%8Crpm%E3%80%8D%E3%81%AF%E3%80%81Red%20Hat,%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%95%E3%82%8C%E3%81%BE%E3%81%99%E3%80%82

https://www.kinakomotitti.net/entry/2018/07/03/213449


# lsコマンド

|オプション|内容|
|---|---|
|-a|隠しファイルも表示する|
|-A|隠しファイルも表示する<br />ただし、`.`と`..`は表示しない|
|-
|-R|サブディレクトリーも再帰的に表示する|
|-i|inode番号を表示する|

# リダイレクト

|標準入力|プログラムの標準的な入力。多くの場合キーボード|
|標準出力|プログラムの標準的な出力。ディスプレイ|
|標準エラー出力|エラーメッセージを出力する出力。ディスプレイ|

リダイレクトは、このンhy風出力先を変更することです。

`<`が入力リダイレクト。

`>`が出力リダイレクト。

`2>`が標準エラー出力リダイレクト。

`2&>1`とすることで、標準出力と標準エラー出力をまとめてリダイレクトできる。

# パイプライン

あるコマンドの標準出力を、別のコマンドの標準入力につなぐことができ、用いるのがパイプライン（`|`）です。

# プロセス

プロセスからプロセスIDを調べる。`pgrep`。`-u`で特定ユーザーが実行しているプロセスのみを表示できる。

`CONT` 一時停止しているプロセスを再開
## nice値

実行優先度。値は-20から19まであり、**値が高いほど優先度は低くなる**。

通常値は0。

`nice`コマンドで優先度を指定しつつプロセスを起動できる。nice値の指定を省略した場合は10が設定される。

`ps l`や`top`コマンドでnice値を確認できる。

`renice`で既に起動しているプロセスのnice値を変更する


## kill

プロセスにシグナルを送る。

クリーンアップせずに終了`SIGKILL`、`9`。

## pgrep

`-U` そのユーザーが実行したプロセス。

`-u` その権限で動作しているプロセス。


# ジョブ

`nohup`でログアウト後もジョブを実行し続ける。

末尾に`&をつけ、コマンドをバックグラウンドで実行する。

# grep

拡張正規表現を利用するには、`grep -E`とするか`egrep`コマンドを用いる。

-nで行番号を付ける。

`-i`で大文字小文字を区別しない。

`-E`で拡張正規表現を利用する。

`-v`で一致しないものを出力する。

`-Fでエスケープ？

`grep -F '.*'`

`-c`でマッチした行数のみ表示する